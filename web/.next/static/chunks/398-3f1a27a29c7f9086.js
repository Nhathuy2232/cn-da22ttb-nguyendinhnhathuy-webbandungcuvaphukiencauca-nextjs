"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{344:(e,t,r)=>{r.d(t,{u:()=>n});let s=r(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:4000/api";class a{getAuthToken(){return localStorage.getItem("accessToken")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{requiresAuth:r=!1,headers:s={},...a}=t,n={"Content-Type":"application/json",...s};if(r){let e=this.getAuthToken();e&&(n.Authorization="Bearer ".concat(e))}let o=await fetch("".concat(this.baseUrl).concat(e),{...a,headers:n});if(!o.ok){let e=await o.json().catch(()=>({success:!1,message:"An error occurred"}));throw 401===o.status&&localStorage.removeItem("accessToken"),Error(e.message||"HTTP ".concat(o.status))}return o.json()}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){var t;let r=await this.request("/auth/login",{method:"POST",body:JSON.stringify(e)});return(null==(t=r.data)?void 0:t.accessToken)&&localStorage.setItem("accessToken",r.data.accessToken),r}async logout(){let e=await this.request("/auth/logout",{method:"POST",requiresAuth:!0});return localStorage.removeItem("accessToken"),e}async getMe(){return this.request("/auth/me",{requiresAuth:!0})}async getProducts(e){let t=new URLSearchParams;(null==e?void 0:e.search)&&t.set("search",e.search),(null==e?void 0:e.category)&&t.set("category",e.category),(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString());let r=t.toString();return this.request("/products".concat(r?"?".concat(r):""))}async getProduct(e){return this.request("/products/".concat(e))}async getCategories(){return this.request("/categories")}async getCategory(e){return this.request("/categories/".concat(e))}async getCart(){return this.request("/cart",{requiresAuth:!0})}async addToCart(e){return this.request("/cart",{method:"POST",body:JSON.stringify(e),requiresAuth:!0})}async updateCartItem(e,t){return this.request("/cart",{method:"PUT",body:JSON.stringify({product_id:e,quantity:t}),requiresAuth:!0})}async removeCartItem(e){return this.request("/cart/".concat(e),{method:"DELETE",requiresAuth:!0})}async clearCart(){return this.request("/cart",{method:"DELETE",requiresAuth:!0})}async createOrder(e){return this.request("/orders",{method:"POST",body:JSON.stringify(e),requiresAuth:!0})}async getOrders(){return this.request("/orders",{requiresAuth:!0})}async getOrder(e){return this.request("/orders/".concat(e),{requiresAuth:!0})}constructor(e){this.baseUrl=e}}let n=new a(s)},1398:(e,t,r)=>{r.d(t,{Header:()=>g});var s=r(5155),a=r(6651),n=r(512),o=r(508),c=r(4926),i=r(2619),l=r.n(i),u=r(9300),h=r(8892),d=r(2115),m=r(63);function g(){var e;let{user:t,isAuthenticated:r,logout:i}=(0,u.A)(),{cart:g}=(0,h._)(),x=(0,m.useRouter)(),[f,y]=(0,d.useState)(""),p=async()=>{await i()},v=(null==g||null==(e=g.items)?void 0:e.length)||0;return(0,s.jsx)("header",{className:"bg-primary-600 text-white shadow-md",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-8 py-4",children:[(0,s.jsx)(l(),{href:"/",className:"flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("svg",{className:"w-10 h-10",viewBox:"0 0 64 64",fill:"white",children:[(0,s.jsx)("path",{d:"M32 8C18.7 8 8 18.7 8 32s10.7 24 24 24 24-10.7 24-24S45.3 8 32 8zm0 4c11.1 0 20 8.9 20 20s-8.9 20-20 20-20-8.9-20-20S20.9 12 32 12z"}),(0,s.jsx)("path",{d:"M28 22v20l16-10z",fill:"#f97316"})]}),(0,s.jsx)("span",{className:"text-2xl font-bold",children:"Cần Thủ Shop"})]})}),(0,s.jsx)("div",{className:"flex-1 max-w-xl",children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f.trim()&&x.push("/products?search=".concat(encodeURIComponent(f.trim())))},className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"T\xecm cần c\xe2u, m\xe1y c\xe2u, mồi c\xe2u...",value:f,onChange:e=>y(e.target.value),className:"w-full rounded px-4 py-2.5 pr-12 text-gray-700 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-300"}),(0,s.jsx)("button",{type:"submit",className:"absolute right-0 top-0 h-full bg-orange-500 px-5 hover:bg-orange-600 rounded-r transition-colors",children:(0,s.jsx)(a.A,{className:"w-5 h-5"})})]})}),(0,s.jsxs)("nav",{className:"flex items-center gap-6",children:[(0,s.jsx)(l(),{href:"/",className:"text-white hover:text-orange-300 transition-colors font-medium",children:"Trang chủ"}),(0,s.jsx)(l(),{href:"/products",className:"text-white hover:text-orange-300 transition-colors font-medium",children:"Sản phẩm"}),(0,s.jsx)(l(),{href:"/about",className:"text-white hover:text-orange-300 transition-colors font-medium",children:"Giới thiệu"}),(0,s.jsx)(l(),{href:"/blogs",className:"text-white hover:text-orange-300 transition-colors font-medium",children:"Blog"}),r&&(null==t?void 0:t.role)==="admin"&&(0,s.jsx)(l(),{href:"/admin/dashboard",className:"text-orange-300 hover:text-white transition-colors font-bold border border-orange-300 px-3 py-1 rounded",children:"Dashboard"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-6 flex-shrink-0",children:[(0,s.jsx)(l(),{href:"/cart",className:"hover:text-orange-100 transition-colors",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.A,{className:"w-7 h-7"}),(0,s.jsx)("span",{className:"absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-white text-xs text-primary-600 font-semibold",children:v})]})}),r&&t?(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(l(),{href:"/profile",className:"hover:text-orange-100 transition-colors flex items-center gap-2",children:[(0,s.jsx)(o.A,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"text-sm whitespace-nowrap",children:t.fullName||t.email})]}),(0,s.jsx)("button",{onClick:p,className:"hover:text-orange-100 transition-colors flex items-center gap-2",title:"Đăng xuất",children:(0,s.jsx)(c.A,{className:"w-5 h-5"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{href:"/login",className:"hover:text-orange-100 transition-colors text-sm whitespace-nowrap",children:"Đăng nhập"}),(0,s.jsx)(l(),{href:"/register",className:"hover:text-orange-100 transition-colors text-sm whitespace-nowrap",children:"Đăng k\xfd"})]})]})]})})})}},8892:(e,t,r)=>{r.d(t,{_:()=>n});var s=r(2115),a=r(344);function n(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!0),[o,c]=(0,s.useState)(null),i=(0,s.useCallback)(async()=>{try{n(!0);let e=await a.u.getCart();t(e.data)}catch(e){c(e instanceof Error?e.message:"Failed to fetch cart")}finally{n(!1)}},[]);return(0,s.useEffect)(()=>{i()},[i]),{cart:e,loading:r,error:o,addItem:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{let r=await a.u.addToCart({product_id:e,quantity:t});return r.success&&await i(),r}catch(e){throw e}},updateItem:async(e,t)=>{try{let r=await a.u.updateCartItem(e,t);return r.success&&await i(),r}catch(e){throw e}},removeItem:async e=>{try{let t=await a.u.removeCartItem(e);return t.success&&await i(),t}catch(e){throw e}},clearCart:async()=>{try{let e=await a.u.clearCart();return e.success&&await i(),e}catch(e){throw e}},refresh:i}}},9300:(e,t,r)=>{r.d(t,{A:()=>i,AuthProvider:()=>c});var s=r(5155),a=r(2115),n=r(344);let o=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[i,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{!async function(){try{if(localStorage.getItem("accessToken")){let e=await n.u.getMe();e.success?c(e.data):localStorage.removeItem("accessToken")}}catch(e){console.log("Token đ\xe3 hết hạn hoặc kh\xf4ng hợp lệ"),localStorage.removeItem("accessToken"),c(null)}finally{l(!1)}}()},[]);let u=async(e,t)=>{try{let r=await n.u.login({email:e,password:t});r.success&&c(r.data.user)}catch(e){throw e}},h=async(e,t,r)=>{try{let s=await n.u.register({full_name:e,email:t,password:r});s.success&&c(s.data.user)}catch(e){throw e}},d=async()=>{try{await n.u.logout()}catch(e){console.error("Logout error:",e)}finally{c(null),localStorage.removeItem("accessToken")}};return(0,s.jsx)(o.Provider,{value:{user:r,loading:i,login:u,register:h,logout:d,isAuthenticated:!!r},children:t})}function i(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);