(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[902],{228:(e,t,a)=>{"use strict";function s(e){return Math.round("string"==typeof e?parseFloat(e):e).toLocaleString("vi-VN")+"₫"}a.d(t,{$:()=>s})},1010:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},1360:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},1847:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(2115);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:d="",children:o,iconNode:h,...m}=e;return(0,s.createElement)("svg",{ref:t,...i,width:r,height:r,stroke:a,strokeWidth:c?24*Number(n)/Number(r):n,className:l("lucide",d),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(o)?o:[o]])}),c=(e,t)=>{let a=(0,s.forwardRef)((a,i)=>{let{className:c,...d}=a;return(0,s.createElement)(n,{ref:i,iconNode:t,className:l("lucide-".concat(r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),c),...d})});return a.displayName=r(e),a}},2219:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(5155),r=a(2115),l=a(228),i=a(6191),n=a(1010),c=a(1360),d=a(5229);function o(){let[e,t]=(0,r.useState)([]),[a,o]=(0,r.useState)([]),[h,m]=(0,r.useState)(!0),[x,u]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),[y,f]=(0,r.useState)({product_id:"",discount_percentage:"",start_time:"",end_time:"",status:"active"});(0,r.useEffect)(()=>{j(),b()},[]);let j=async()=>{try{let e=localStorage.getItem("accessToken"),a=await fetch("http://localhost:4000/api/flash-sales",{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();t(e.data||[])}}catch(e){console.error("Error fetching flash sales:",e)}finally{m(!1)}},b=async()=>{try{let e=localStorage.getItem("accessToken"),t=await fetch("http://localhost:4000/api/admin/products?limit=100",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();o(e.items||[])}}catch(e){console.error("Error fetching products:",e)}},v=e=>{if(e)g(e),f({product_id:e.product_id.toString(),discount_percentage:e.discount_percentage.toString(),start_time:new Date(e.start_time).toISOString().slice(0,16),end_time:new Date(e.end_time).toISOString().slice(0,16),status:"expired"===e.status?"inactive":e.status});else{g(null);let e=new Date,t=new Date(e.getTime()+864e5);f({product_id:"",discount_percentage:"",start_time:e.toISOString().slice(0,16),end_time:t.toISOString().slice(0,16),status:"active"})}u(!0)},N=()=>{u(!1),g(null)},w=async e=>{e.preventDefault();try{let e=localStorage.getItem("accessToken"),t=p?"http://localhost:4000/api/flash-sales/".concat(p.id):"http://localhost:4000/api/flash-sales",a={product_id:parseInt(y.product_id),discount_percentage:parseFloat(y.discount_percentage),start_time:new Date(y.start_time).toISOString(),end_time:new Date(y.end_time).toISOString(),status:y.status},s=await fetch(t,{method:p?"PATCH":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(a)}),r=await s.json();s.ok?(alert(r.message||"Lưu flash sale th\xe0nh c\xf4ng!"),N(),j()):alert(r.message||"C\xf3 lỗi xảy ra!")}catch(e){console.error("Error saving flash sale:",e),alert("C\xf3 lỗi xảy ra khi lưu flash sale!")}},k=async e=>{if(confirm("Bạn c\xf3 chắc chắn muốn x\xf3a flash sale n\xe0y?"))try{let t=localStorage.getItem("accessToken"),a=await fetch("http://localhost:4000/api/flash-sales/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),s=await a.json();a.ok?(alert(s.message||"X\xf3a flash sale th\xe0nh c\xf4ng!"),j()):alert(s.message||"C\xf3 lỗi xảy ra!")}catch(e){console.error("Error deleting flash sale:",e),alert("C\xf3 lỗi xảy ra khi x\xf3a flash sale!")}};return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Quản l\xfd Flash Sale"}),(0,s.jsxs)("button",{onClick:()=>v(),className:"flex items-center gap-2 rounded-lg bg-orange-600 px-4 py-2 text-white hover:bg-orange-700",children:[(0,s.jsx)(i.A,{className:"h-5 w-5"}),"Th\xeam Flash Sale"]})]}),h?(0,s.jsx)("p",{children:"Đang tải..."}):(0,s.jsxs)("div",{className:"overflow-x-auto rounded-lg bg-white shadow",children:[(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Sản phẩm"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Gi\xe1 gốc"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Giảm gi\xe1"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Gi\xe1 sau giảm"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Thời gian"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Trạng th\xe1i"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Thao t\xe1c"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("img",{src:e.product_thumbnail||"/images/placeholder.png",alt:e.product_name,className:"h-10 w-10 rounded object-cover"}),(0,s.jsx)("span",{className:"ml-3 font-medium",children:e.product_name})]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,l.$)(e.product_price)}),(0,s.jsxs)("td",{className:"px-6 py-4 text-sm font-semibold text-orange-600",children:["-",e.discount_percentage,"%"]}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm font-bold text-green-600",children:(0,l.$)(e.discounted_price)}),(0,s.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500",children:[(0,s.jsx)("div",{children:new Date(e.start_time).toLocaleString("vi-VN")}),(0,s.jsx)("div",{className:"text-xs",children:"đến"}),(0,s.jsx)("div",{children:new Date(e.end_time).toLocaleString("vi-VN")})]}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("span",{className:"inline-flex rounded-full px-2 py-1 text-xs font-semibold ".concat((e=>{let t={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",expired:"bg-red-100 text-red-800"};return t[e]||t.inactive})(e.status)),children:"active"===e.status?"Đang hoạt động":"expired"===e.status?"Hết hạn":"Kh\xf4ng hoạt động"})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>v(e),className:"text-blue-600 hover:text-blue-800",title:"Sửa",children:(0,s.jsx)(n.A,{className:"h-5 w-5"})}),(0,s.jsx)("button",{onClick:()=>k(e.id),className:"text-red-600 hover:text-red-800",title:"X\xf3a",children:(0,s.jsx)(c.A,{className:"h-5 w-5"})})]})})]},e.id))})]}),0===e.length&&(0,s.jsx)("p",{className:"p-6 text-center text-gray-500",children:"Chưa c\xf3 flash sale n\xe0o"})]}),x&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"max-h-[90vh] w-full max-w-2xl overflow-y-auto rounded-lg bg-white p-6",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:p?"Chỉnh sửa Flash Sale":"Th\xeam Flash Sale mới"}),(0,s.jsx)("button",{onClick:N,className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,s.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Sản phẩm *"}),(0,s.jsxs)("select",{required:!0,value:y.product_id,onChange:e=>f({...y,product_id:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2",disabled:!!p,children:[(0,s.jsx)("option",{value:"",children:"-- Chọn sản phẩm --"}),a.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," - ",(0,l.$)(e.price)]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phần trăm giảm gi\xe1 (%) *"}),(0,s.jsx)("input",{type:"number",required:!0,min:"1",max:"100",step:"0.01",value:y.discount_percentage,onChange:e=>f({...y,discount_percentage:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2",placeholder:"V\xed dụ: 20"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Thời gian bắt đầu *"}),(0,s.jsx)("input",{type:"datetime-local",required:!0,value:y.start_time,onChange:e=>f({...y,start_time:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Thời gian kết th\xfac *"}),(0,s.jsx)("input",{type:"datetime-local",required:!0,value:y.end_time,onChange:e=>f({...y,end_time:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Trạng th\xe1i *"}),(0,s.jsxs)("select",{required:!0,value:y.status,onChange:e=>f({...y,status:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2",children:[(0,s.jsx)("option",{value:"active",children:"Đang hoạt động"}),(0,s.jsx)("option",{value:"inactive",children:"Kh\xf4ng hoạt động"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)("button",{type:"button",onClick:N,className:"rounded-lg border border-gray-300 px-4 py-2 hover:bg-gray-50",children:"Hủy"}),(0,s.jsx)("button",{type:"submit",className:"rounded-lg bg-orange-600 px-4 py-2 text-white hover:bg-orange-700",children:p?"Cập nhật":"Th\xeam mới"})]})]})]})})]})}},4213:(e,t,a)=>{Promise.resolve().then(a.bind(a,2219))},5229:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6191:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},e=>{e.O(0,[441,255,358],()=>e(e.s=4213)),_N_E=e.O()}]);