(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},344:(e,t,r)=>{"use strict";r.d(t,{u:()=>o});let s=r(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:4000/api";class a{getAuthToken(){return localStorage.getItem("accessToken")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{requiresAuth:r=!1,headers:s={},...a}=t,o={"Content-Type":"application/json",...s};if(r){let e=this.getAuthToken();e&&(o.Authorization="Bearer ".concat(e))}let n=await fetch("".concat(this.baseUrl).concat(e),{...a,headers:o});if(!n.ok){let e=await n.json().catch(()=>({success:!1,message:"An error occurred"}));throw 401===n.status&&localStorage.removeItem("accessToken"),Error(e.message||"HTTP ".concat(n.status))}return n.json()}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){var t;let r=await this.request("/auth/login",{method:"POST",body:JSON.stringify(e)});return(null==(t=r.data)?void 0:t.accessToken)&&localStorage.setItem("accessToken",r.data.accessToken),r}async logout(){let e=await this.request("/auth/logout",{method:"POST",requiresAuth:!0});return localStorage.removeItem("accessToken"),e}async getMe(){return this.request("/auth/me",{requiresAuth:!0})}async getProducts(e){let t=new URLSearchParams;(null==e?void 0:e.search)&&t.set("search",e.search),(null==e?void 0:e.category)&&t.set("category",e.category),(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString());let r=t.toString();return this.request("/products".concat(r?"?".concat(r):""))}async getProduct(e){return this.request("/products/".concat(e))}async getCategories(){return this.request("/categories")}async getCategory(e){return this.request("/categories/".concat(e))}async getCart(){return this.request("/cart",{requiresAuth:!0})}async addToCart(e){return this.request("/cart",{method:"POST",body:JSON.stringify(e),requiresAuth:!0})}async updateCartItem(e,t){return this.request("/cart",{method:"PUT",body:JSON.stringify({product_id:e,quantity:t}),requiresAuth:!0})}async removeCartItem(e){return this.request("/cart/".concat(e),{method:"DELETE",requiresAuth:!0})}async clearCart(){return this.request("/cart",{method:"DELETE",requiresAuth:!0})}async createOrder(e){return this.request("/orders",{method:"POST",body:JSON.stringify(e),requiresAuth:!0})}async getOrders(){return this.request("/orders",{requiresAuth:!0})}async getOrder(e){return this.request("/orders/".concat(e),{requiresAuth:!0})}constructor(e){this.baseUrl=e}}let o=new a(s)},479:(e,t,r)=>{Promise.resolve().then(r.bind(r,1957))},1957:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(5155),a=r(2115),o=r(9300),n=r(63),c=r(2619),i=r.n(c);function l(){let[e,t]=(0,a.useState)(""),[r,c]=(0,a.useState)(""),[l,u]=(0,a.useState)(""),[d,m]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[y,p]=(0,a.useState)(!1),{register:x}=(0,o.A)(),f=(0,n.useRouter)(),v=async t=>{if(t.preventDefault(),g(""),l!==d)return void g("Mật khẩu x\xe1c nhận kh\xf4ng khớp");if(l.length<6)return void g("Mật khẩu phải c\xf3 \xedt nhất 6 k\xfd tự");p(!0);try{await x(e,r,l),f.push("/")}catch(e){g(e instanceof Error?e.message:"Đăng k\xfd thất bại")}finally{p(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Đăng k\xfd t\xe0i khoản"}),(0,s.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Đ\xe3 c\xf3 t\xe0i khoản?"," ",(0,s.jsx)(i(),{href:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"Đăng nhập ngay"})]})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:v,children:[h&&(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,s.jsx)("div",{className:"text-sm text-red-700",children:h})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Họ v\xe0 t\xean"}),(0,s.jsx)("input",{id:"fullName",name:"fullName",type:"text",required:!0,value:e,onChange:e=>t(e.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:""})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:r,onChange:e=>c(e.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:""})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Mật khẩu"}),(0,s.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:l,onChange:e=>u(e.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Tối thiểu 6 k\xfd tự"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"X\xe1c nhận mật khẩu"}),(0,s.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:d,onChange:e=>m(e.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Nhập lại mật khẩu"})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,s.jsxs)("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-900",children:["T\xf4i đồng \xfd với"," ",(0,s.jsx)("a",{href:"#",className:"text-primary-600 hover:text-primary-500",children:"Điều khoản dịch vụ"})," ","v\xe0"," ",(0,s.jsx)("a",{href:"#",className:"text-primary-600 hover:text-primary-500",children:"Ch\xednh s\xe1ch bảo mật"})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:y,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Đang đăng k\xfd...":"Đăng k\xfd"})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i(),{href:"/",className:"text-sm text-gray-600 hover:text-gray-900",children:"← Quay lại trang chủ"})})]})]})})}},9300:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>c});var s=r(5155),a=r(2115),o=r(344);let n=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[i,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{!async function(){try{if(localStorage.getItem("accessToken")){let e=await o.u.getMe();e.success?c(e.data):localStorage.removeItem("accessToken")}}catch(e){console.log("Token đ\xe3 hết hạn hoặc kh\xf4ng hợp lệ"),localStorage.removeItem("accessToken"),c(null)}finally{l(!1)}}()},[]);let u=async(e,t)=>{try{let r=await o.u.login({email:e,password:t});r.success&&c(r.data.user)}catch(e){throw e}},d=async(e,t,r)=>{try{let s=await o.u.register({full_name:e,email:t,password:r});s.success&&c(s.data.user)}catch(e){throw e}},m=async()=>{try{await o.u.logout()}catch(e){console.error("Logout error:",e)}finally{c(null),localStorage.removeItem("accessToken")}};return(0,s.jsx)(n.Provider,{value:{user:r,loading:i,login:u,register:d,logout:m,isAuthenticated:!!r},children:t})}function i(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=479)),_N_E=e.O()}]);